---
title: 'IEC104 批量导入示例'
description: 'IEC 60870-5-104：批量点位、批量动作、批量设备+点位导入的模板字段说明与可复制示例。'
---

当你在 IEC104 场景需要一次性创建大量：

- 点位（Point）
- 动作（Action）
- 设备 + 点位（Device + Points）

可以使用网关提供的 **Excel 导入模板**，用“预览（preview）→ 提交（commit）”两步完成批量建模。

::: warning 注意
请始终从网关[下载模板](./driver-metadata-schema.md#driver-template-download)再填写。不要修改表头，也不要删除隐藏的 `__meta__` sheet，否则导入会失败。
:::

## 前置条件

- 已创建一个 IEC104 通道

## 1) 批量设备 + 点位导入

### 使用入口

- 下载模板
![Driver template download](./assets/driver-template-download.png)

- 预览校验
![Import prewview](./assets/import-preview.png)

- 提交写入

### 模板字段

Device 基础字段：
> Tip：每行都要填，且同一设备名的多行必须一致

- **设备名称**：`device_name`
- **设备类型**：`device_type`

Device驱动配置：
- **公共地址**：IEC104 Device 驱动配置（CA），必填

Point 基础字段（**每行一个点位**） ：

- **名称**：点位名称
- **键名**：点位 key（对外稳定标识）
- **类型**：属性/遥测（下拉）
- **数据类型**：Boolean/Int16/Float64/...（下拉）
- **访问模式**：只读/只写/读写（下拉）
- **单位**（可选）
- **最小值/最大值**（可选）
- **缩放比例**（可选）

Point 驱动配置：

- **IOA**：信息对象地址，必填
- **ASDU类型**：点位类型（测量类 M_*，下拉），必填

::: tip 一致性校验
同一个“设备名称”的多行里，**设备类型**与**公共地址**必须一致，否则 preview 会报错。
:::

### 示例

下面示例按模板表头（中文）给出，复制时只需要把数值填到对应列即可：

| 设备名称 | 设备类型 | 公共地址 | 名称 | 键名 | 类型 | 数据类型 | 访问模式 | 单位 | 最小值 | 最大值 | 缩放比例 | IOA | ASDU类型 |
| --- | --- | ---: | --- | --- | --- | --- | --- | --- | --- | --- | --- | ---: | --- |
| iec104-st01 | Station | 1 | 遥信1 | yx_1 | 遥测 | Boolean | 只读 |  |  |  |  | 1001 | 单点无时标 |
| iec104-st01 | Station | 1 | 遥测1 | yc_1 | 遥测 | Float32 | 只读 | A | 0 | 100 | 1 | 2001 | 短浮点数无时标 |
| iec104-st02 | Station | 2 | 遥信2 | yx_2 | 遥测 | Boolean | 只读 |  |  |  |  | 1002 | 单点无时标 |
| iec104-st02 | Station | 2 | 遥测2 | yc_2 | 遥测 | Float32 | 只读 | ℃ | -40 | 150 | 1 | 2002 | 短浮点数无时标 |

## 2) 批量点位导入

### 使用入口

- 下载模板
![Driver template download](./assets/driver-template-download.png)

- 预览校验
![Import prewview](./assets/import-preview.png)

- 提交写入

### 模板字段

- 点位基础字段：名称、键名、类型、数据类型、访问模式、单位、最小值、最大值、缩放比例
- IEC104 点位驱动字段：IOA、ASDU类型（测量类 M_*）

### 示例

| 名称 | 键名 | 类型 | 数据类型 | 访问模式 | 单位 | 最小值 | 最大值 | 缩放比例 | IOA | ASDU类型 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | ---: | --- |
| 遥信1 | yx_1 | 遥测 | Boolean | 只读 |  |  |  |  | 1001 | 单点无时标 |
| 遥信2 | yx_2 | 遥测 | Boolean | 只读 |  |  |  |  | 1002 | 单点无时标 |
| 遥测1 | yc_1 | 遥测 | Float32 | 只读 | ℃ | -40 | 150 | 1 | 2001 | 短浮点数无时标 |

## 3) 批量动作导入

### 使用入口

- 下载模板
![Driver template download](./assets/driver-template-download.png)

- 预览校验
![Import prewview](./assets/import-preview.png)

- 提交写入

::: tip 关键语义
**动作导入是“每行一个参数”，会自动聚合**

- Excel 模板里 **一行对应一个参数**（Parameter）
- 后端在 commit 时会按 `(动作名称-name, 命令-command)` 聚合多行参数为一个 Action
- IEC104 的 **IOA/ASDU类型** 是“参数级驱动配置”（即每个参数自己对应一个 IOA/typeId）
:::

### 模板字段说明

Action 基础字段（同一动作的多行保持一致）：

- **动作名称**：如“合闸/分闸/复位”
- **命令**：对外稳定标识（用于区分动作/便于检索；IEC104 协议细节不放这里）

Parameter 字段（每行不同）：

- **参数名称**：展示名
- **参数键名**：稳定 key（调用动作时按 key 传参）
- **数据类型**：下拉
- **是否必填**：true/false
- **默认值/最小值/最大值**：可选

IEC104 参数驱动字段：

- **IOA**
- **ASDU类型**：动作类型（命令类 C_*，下拉）

### 示例

| 动作名称 | 命令 | 参数名称 | 参数键名 | 数据类型 | 是否必填 | 默认值 | 最小值 | 最大值 | IOA | ASDU类型 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | ---: | --- |
| 遥控-合闸 | close | 合闸 | close | Boolean | true |  |  |  | 3001 | 单点命令无时标 |
| 遥控-合闸 | close | 分闸 | open | Boolean | true |  |  |  | 3002 | 单点命令无时标 |

::: tip 调用时
给 `close=true` 会对 IOA=3001 下发；给 `open=true` 会对 IOA=3002 下发。一个动作包含多个参数时，驱动会按参数列表逐条下发（串行）。
:::

## 常见错误与排查

### 1) 提示 driver/entity mismatch

说明你用错了模板（或模板被修改/缺失 `__meta__`）。请重新下载正确 entity 的模板。

### 2) 提示“device_type/公共地址 不一致”

同一个设备名对应多行点位时，**设备类型**与**公共地址（CA）**必须一致；建议先在 Excel 里用筛选按设备名检查。

### 3) 枚举字段填了自定义文本导致失败

例如 “数据类型/访问模式/ASDU类型”。请使用模板自带的下拉选项；不要自己手敲非模板文本。


